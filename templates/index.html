<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Sistema de Gestão</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div style="background-color: #34495e; color: white; padding: 10px 20px; text-align: right; margin-bottom: 15px;">
    {% if session.user_name %}
        <span>Bem-vindo, <strong>{{ session.user_name }}</strong>!</span>
        <a href="{{ url_for('logout') }}" style="color: #ecf0f1; margin-left: 15px; text-decoration: none;">Sair</a>
    {% endif %}
    </div>
    <div class="container">
        <h1 class="main-title">Dashboard</h1>
        <p class="subtitle">Visão geral das atividades recentes e pendências.</p>

        <div class="dashboard-grid">
            
            <div class="dashboard-card">
                <h2>Próximos Agendamentos</h2>
                <ul>
                    {% if proximos_agendamentos %}
                        {% for item in proximos_agendamentos %}
                            <li>
                                <strong>{{ item['cliente'] }}</strong> ({{ item['tecnico'] }})
                                <span class="meta">{{ item['data_agendamento'] | dateformat }} - {{ item['motivo'] }}</span>
                            </li>
                        {% endfor %}
                    {% else %}
                        <li class="no-data">Nenhum agendamento futuro.</li>
                    {% endif %}
                </ul>
            </div>

            <div class="dashboard-card">
                <h2>Pendências em Aberto</h2>
                <ul>
                    {% if pendencias_abertas %}
                        {% for item in pendencias_abertas %}
                            <li>
                                <strong>{{ item['processo'] }}</strong> - {{ item['cliente'] }}
                                <span class="meta">Prazo: {{ item['prazo_entrega'] | dateformat if item['prazo_entrega'] else 'Não definido' }}</span>
                            </li>
                        {% endfor %}
                    {% else %}
                        <li class="no-data">Nenhuma pendência em aberto.</li>
                    {% endif %}
                </ul>
            </div>

            <div class="dashboard-card">
                <h2>Técnicos em Férias Hoje</h2>
                <ul>
                    {% if tecnicos_em_ferias %}
                        {% for item in tecnicos_em_ferias %}
                            <li>
                                <strong>{{ item['funcionario'] }}</strong>
                                <span class="meta">Retorna em: {{ item['data_termino'] | dateformat }}</span>
                            </li>
                        {% endfor %}
                    {% else %}
                        <li class="no-data">Nenhum técnico em férias hoje.</li>
                    {% endif %}
                </ul>
            </div>

        </div>

        <h2 class="modules-section-title">Acessar Módulos do Sistema</h2>
        <div class="module-grid">
            <a href="{{ url_for('cadastros') }}" class="module-button">Módulo de Cadastros</a>
            <a href="{{ url_for('pendencias') }}" class="module-button">Módulo de Pendências</a>
            <a href="{{ url_for('ferias') }}" class="module-button">Módulo de Férias</a>
            <a href="{{ url_for('agenda') }}" class="module-button">Módulo de Agenda</a>
            <a href="{{ url_for('usuarios') }}" class="module-button">Gestão de Usuários</a>
            <a href="{{ url_for('prestacao_contas') }}" class="module-button">Prestação de Contas</a>
        </div>
    </div>
</body>
</html>